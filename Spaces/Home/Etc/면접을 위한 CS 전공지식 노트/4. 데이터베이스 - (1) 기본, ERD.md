## 기본
데이터베이스란 일정한 규칙, 혹은 규약을 통해 구조화되어 저장되는 데이터의 모읍이다.
해당 데이터베이스를 제어, 관리하는 통합 시스템을 DBMS라고 한다

### 엔티티(entity)
예를 들어 회원이라는 엔티티가 있을 때, 회우너은 이름, 아이디, 주소 , 전화번호의 속성을 갖는다. 

#### **강한 엔터티** VS **약한 엔터티**  
독립성이 강하다, 약하다로 읽었다.

강한 엔터티 : 혼자 존재할 수 있는 엔티티 
약한 엔터티 : 다른 엔터티의 존재 여부에 따라 종속적인 엔티티

### 릴레이션(relation)
데이터베이스에서 정보를 구분하여 저장하는 기본 단위다.
![[IMG-20250609194028285.png|400]]
- 관계형 데이터베이스 릴레이션 : `테이블`
- NoSQL 데이터베이스 릴레이션 : `컬렉션`

### 속성(attribute)
릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보
- '차'라는 속성으로 차 넘버, 바퀴 수, 차 색깔, 차종 등이 있다.

### 도메인(domain)
릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합
- '성별'이라는 속성이 있다면 `{남, 여}`가 도메인

### 필드와 레코드
![[IMG-20250609194028380.png|400]]

- 회원이란 **엔티티**는 member라는 **테이블**로 **속성**인 이름, 아이디 등을 가지고 있음
- `필드` : name, ID, address
- `레코드 (튜플)` : 테이블에 쌓이는 행(row) 단위의 데이터

#### 필드 타입
🔗 **큰 데이터 저장 타입**
- **TEXT** : 큰 문자열 저장에 사용
    - 주로 게시판의 본문
- **BLOB** : 이미지, 동영상 등 큰 데이터 저장
    - but, 보통은 아마존 S3를 이용하고 파일 경로를 VARCHAR로 저장

🔗 **문자열 열거 타입**
- **ENUM**
	- ENUM(x-small, small, medium, large, x-large) 형태로 쓰이며 단일 선택만 가능
    - 잘못된 값을 삽입하면 빈 문자열이 대신 삽입
    - x-small 등이 0,1 등으로 매핑되어 메모리를 적게 사용하는 이점
    - 최대 65,535개의 요소
- **SET**
	- ENUM과 비슷하지만, 여러 개의 데이터를 선택할 수 있고 비트 단위의 연산을 할 수 있음
    - 최대 64개의 요소

> ENUM이나 SET을 쓸 경우 공간적으로 이점을 볼 수 있지만, 애플리케이션의 수정에 따라 데이터베이스의 ENUM이나 SET에서 정의한 목록을 수정해야 한다는 단점이 있다.


### 키
테이블 간의 관계를 조금 더 명확하게 하고, 테이블 자체의 인덱스를 위해 설정된 장치
- 기본키, 외래키, 후보키, 슈퍼키, 대체키

![[IMG-20250609194028662.png|250]]

> `유일성` : 중복되는 값이 없음  
> `최소성` : 필드를 조합하지 않고 최소 필드만 써서 키를 형성할 수 있음

#### 기본키
- **유일성**과 **최소성**을 만족하는 키
- 자연키 또는 인조키 중 설정

> `자연키` : 중복되지 않는 것을 '자연스레' 뽑다가 나오는 키(Ex. 주민번호) - 언젠가는 변하는 속성을 가짐  
> `인조키` : 인위적으로 생성한 키(Ex. auto increment) - 변하지 않음 -> 보통 기본키로 사용


#### 외래키
![[IMG-20250609194028780.png|300]]
- 다른 테이블의 기본키를 그대로 참조하는 값
- 개체와의 관계를 식별하는 데 사용
- 중복되어도 


#### 후보키 (candidate key)
- 기본키가 될 수 있는 후보들
- **유일성**과 **최소성**을 동시에 만족하는 키

#### 대체키 (alternate key)
- 후보키가 두 개 이상일 때 기본키로 선택되지 못한 키

#### 슈퍼키 (super key)
- 레코드를 유일하게 식별할 수 있는 **유일성**을 갖춘 키

---
## ERD
> ERD(Entity Relationship Diagram)는 DB를 구축할 때 가장 기초적인 뼈대 역할을 하며, **릴레이션 간의 관계들을 정의**한 것이다. 서비스를 구축할 때 가장 먼저 신경 써야 할 부분이다

- 관계형 DB를 표현하기에 유리하다
- 비정형 DB(NoSQL)에는 적합하지 않다

### 정규화 과정
[[정규화와 비정규화]]

> 정규화 과정은 **릴레이션 간 잘못된 종속 관계를 바로 잡아 중복 데이터를 제거하고, 데이터 정합성(integrity)을 만족하도록 릴레이션을 여러개로 분리하는 과정**을 말한다.

#### 정규형 원칙
- 같은 의미를 표현하는 릴레이션이지만 좀 더 좋은 구조로 만들어야 한다
- 자료의 중복성은 감소하고, 독립적인 관계는 별개의 릴레이션으로 표현해야 한다
- 정규형(정규화된 정도)은 제1정규형~제3정규형, 보이스/코드 정규형이 있다
    - 고급 정규형인 제4정구형,제5정규형 등도 있다

#### 1) 제1정규형
- 모든 도메인이 더 이상 분해될 수 없는 원자값(atomic)으로만 구성되어 있는 상태를 제1정규형이라고 한다
- 릴레이션 속성 값 중 한 개의 PK에 두 개 이상의 값 가지는 반복 집합이 있어서는 안 된다.
    - 반복 집합이 있다면 제거해야 한다

|boardId|userName|content|
|---|---|---|
|1|hongseob|{안녕}, {공부중}|

위와 같은 테이블은 제1정규화가 되어있지 않다. `content` 속성에 값이 2개가 존재하는 경우가 있다  
이것을 나눠서 반복 집합을 제거 해주면 아래처럼 제1정규화를 진행할 수 있다

|boardId|userName|content|
|---|---|---|
|1|hongseob|안녕|
|2|hongseob|공부중|

**이상현상**
대부분 정규형에는 이상현상이 존재한다  
제 1정규형에는 아래와 같은 이상 현상이 존재한다

- 삽입 이상 : 불필요한 정보가 필요함
- 삭제 이상 : 불필요한 정보까지 삭제됨
- 갱신 이상 : 불필요한 정보까지 갱신 필요


#### 2) 제2정규형
- 릴레이션이 제1정규형이며 `부분 함수의 종속성을 제거한 형태`를 말한다
- `부분 함수의 종속성 제거`란 PK가 아닌 모든 속성이 PK에 완전 함수 종속적인 것을 말한다
    - 즉 제1정규형 이며, PK에 속하지 않은 속성 모두가 PK에 완전 함수 종속인 정규형

|boardId|creatorId|contents|commentId|commentViews|
|---|---|---|---|---|
|1|USER1|안녕|1|20|
|2|USER2|등업좀요|2|10|
|3|USER3|공부하자|3|37|
|4|USER4|취업성공|4|132|

위의 테이블은 PK는 `boardId` 이다  

각 게시물은 하나의 작성자, 하나의 내용, 여러 개의 댓글을 가진다. 한 댓글은 하나의 조회수를 가진다  
`creatorId`,`contents`는 `boardId`에 의존하지만 `commentViews`는 `commentId`에 의존한다  
따라서 위의 릴레이션은 부분 함수의 종속성이 존재하므로, 제2정규화를 통해 아래와 같이 분리할 수 있다

|boardId|creatorId|contents|
|---|---|---|
|1|KAKAO00001|안녕|
|2|GOOGL00001|등업좀요|
|3|KAKAO00002|히어로즈 오브 더 스톰|
|4|NAVER00001|네카라쿠배|

|commentId|boardId|commentViews|
|---|---|---|
|1|1|23|
|2|2|21|
|3|3|37|
|4|4|132|

기본키인 `{이름, 수강명}`과 같은 완전 종속된 유저번호 릴레이션과 `{이름, 수강명}`에 따른 성취도 릴레이션으로 분리하였다

**이상현상**
제 2정규형에도 이상현상이 존재한다

- 삽입 이상 : 불필요한 정보가 필요함
- 삭제 이상 : 불필요한 정보까지 삭제됨
- 갱신 이상 : 불필요한 정보까지 갱신 필요

> 여전히 이상현상이 발생하는 이유는 **'이행적 함수 종속성'** 때문이다  
> 이행적 함수 종속성은 속성이 A->B,B->C,이면서, A->C의 관계가 있는 것을 말한다

### 3) 제3정규형
- 제2정규형이고, `기본키가 아닌 모든 속성이 이행적 함수 종속을 만족하지 않는 상태`
    - PK 이외의 속성이 그 외 다른 속성을 결정할 수 없다는 것
![[IMG-20250609194028891.png|400]]


#### 4) 보이스/코드 정규형
- 제3정규형이고, 결정자가 후보키가 아닌 함수 종속 관계를 제거하여 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키인 상태를 말한다
- 즉 제3정규형을 강화시킨 개념
- [이해에 도움이 되는 관련 자료](https://rebro.kr/160)
