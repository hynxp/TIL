후임이 SQLGate에서 CREATE TABLE하는데 유독 한 테이블만 계속 생성이 안 됐다.
read 테이블인가 하니... 다른 테이블은 바로 생성되는걸 보니 그것도 아닌것 같고 구글링했더니 
큐브리드측에서 [REUSE_OID를 붙이라](https://www.cubrid.co.kr/index.php?_filter=search&mid=qna&search_keyword=reuse_oid&search_target=comment&document_srl=3839684)고 했댄다.
근데 정확히 왜 REUSE_OID를 붙여야 하는지는 말해주지 않고 찾아도 없다...;
일단 REUSE_OID 옵션을 붙이니 테이블 생성이 바로 되긴 했는데 이해가 안 가서 Q&A에 글을 남겨본 상태다.

[cubrid 매뉴얼](https://www.cubrid.org/manual/ko/10.2/sql/schema/table_stmt.html#id2)을 확인하면 짧게 설명이 나와있는 데 솔직히 잘 이해가 안 된다..

> [!NOTE] 
OID(Object Identifier)는 볼륨 번호, 페이지 번호, 슬롯 번호와 같은 물리적 위치 정보로 표현되는 객체 식별자이다. 
> CUBRID는 OID를 이용하여 객체의 참조 관계를 관리하고, 객체 조회, 저장, 삭제를 수행한다. 
> OID를 이용하면 테이블을 참조하지 않고도 힙 파일 내의 해당 오브젝트에 직접 접근할 수 있어 접근성이 향상되지만, 객체가 삭제되더라도 참조 관계를 유지하기 위해 해당 객체의 OID를 보존하기 때문에 **DELETE** / **INSERT** 연산이 많은 경우 저장 공간 재사용률이 저하되는 문제가 있다.
> 
> 테이블 생성 시 **REUSE_OID** 옵션을 명시하면, 해당 테이블 내의 데이터 삭제 시 해당 OID가 함께 
> 제되며, **INSERT** 된 다른 데이터가 해당 OID를 재사용할 수 있다. 단, OID 재사용 테이블을 다른 테
> 이블이 참조할 수 없고, OID 재사용 테이블 내 객체들의 OID 값을 조회할 수 없다.

그니까.. **큐브리드는 oid를 이용해서 객체를 캐시(?)하듯이 사용하는데 레코드를 삭제해도 oid는 남아있기 때문에 delete, insert문이 잦으면 저장 공간 재사용이 비효율적**이라는 말인 것 같다.

그래서 **REUSE_OID 옵션을 사용하면 레코드 삭제 시에 oid도 같이 삭제하기 때문에 다른 레코드가 이 oid를 재사용할 수 있는 것**이다! 

하지만 참고사항에서 **다른 테이블이 OID 재사용 테이블을 참조할 수 없다**는 말이 이해가 안 갔다.
> [!CAUTION] 참고
> - 다른 테이블이 OID 재사용 테이블을 참조할 수 없다.
> - OID 재사용 테이블에 대해 갱신 가능한(updatable) 뷰를 생성할 수 없다.
> - 테이블의 칼럼 타입으로 OID 재사용 테이블을 지정할 수 없다.
> - 테이블의 칼럼 타입으로 OID 재사용 테이블을 지정할 수 없다.
> - OID 재사용 테이블 객체들의 OID 값을 읽을 수 없다.
> - OID 재사용 테이블에서 인스턴스 메서드를 호출할 수 없다. 메서드가 정의된 클래스를 상속받은 서브클래스가 OID 재사용 테이블로 정의되어도 마찬가지로 인스턴스 메서드를 호출할 수 없다.
> - OID 재사용 테이블은 CUBRID 2008 R2.2 버전 이상에서만 지원되며, 하위 호환성을 보장하지 않는다. 즉, 더 낮은 버전의 데이터베이스 서버에서 OID 재사용 테이블이 존재하는 데이터베이스에 접근할 수 없다.
> - OID 재사용 테이블은 분할 테이블로 관리될 수 있으며, 복제될 수 있다.

나도 얼마전에 통계 조인쿼리 작성하면서 특정 테이블이 REUSE_OID가 설정돼있어서 참조가 안된다고 에러 문구가 떴었던 터라... 이거랑 관련된 것 같다.

그래서 Q&A에 해당 내용을 찾아보니 이런 답변이 있었다.
![[REUSE_OID(cubrid)-20240509171018592.webp]]
큐브리드에서는 다른 테이블명을 data type으로 사용할 수가 있는데
`createa table a(a int, b int);`
`create table b(name a);`
REUSE_OID 옵션을 사용하면 이렇게 **데이터 타입으로 "참조"를 못한다는 것 같다...**

cubrid는 참 ......... 어려운 DB다... ㅎㅎ 



