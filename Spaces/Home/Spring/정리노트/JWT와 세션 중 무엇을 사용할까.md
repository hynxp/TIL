JWT(Json Web Token)와 세션은 모두 사용자 인증을 위한 기술로 많이 사용되며, 각기 다른 장단점을 가지고 있다. 이를 언제, 어떻게 선택해야 할지 명확히 이해하려면 다양한 환경과 요구사항을 고려해야 한다. 아래에서는 JWT와 세션의 차이점, 그리고 상황별로 어떻게 선택하면 좋을지에 대해 설명한다.


## JWT와 세션의 기본 개념과 차이점

### JWT
[[JWT]]는 클라이언트 측에서 인증 정보를 보관하고, 
서버는 이를 검증만 하는 방식이다. JWT는 주로 다음과 같은 특징을 가진다

- **Stateless(무상태성)**: 서버는 사용자의 상태를 유지하지 않는다.
- **Self-contained**: 토큰 자체에 인증 정보가 포함되어 있다.
- **확장성**: 서버가 여러 대로 확장되어도 상태를 공유할 필요가 없어 운영이 간단하다.

### 세션
[[10. 세션|세션]]은 서버가 사용자 상태를 유지하며, 클라이언트는 세션 ID만 전달한다. 주요 특징은 다음과 같다:

- **Stateful(상태 유지)**: 서버가 상태를 유지하기 때문에 클라이언트 정보가 서버에 저장된다.
- **보안성**: 클라이언트에 민감한 정보가 저장되지 않아 보안성이 더 높다.
- **복잡성**: 서버가 여러 대로 확장될 경우, 세션 저장소(Redis, Memcached 


## 상황에 따른 판단 기준
JWT와 세션 중 어떤 것을 선택할지 결정하기 위해서는 다음과 같은 질문들을 고려해야 한다.

### 1. **시스템의 확장성이 중요한가?**
- 서버가 여러 대로 확장되거나 클라우드 환경에서 사용된다면 **JWT**가 유리하다. 서버 간 상태를 공유할 필요가 없기 때문이다.
- 반대로 서버가 단일 환경에서 작동한다면 세션도 충분히 적합하다.

### 2. **보안 수준이 중요한가?**
- 매우 민감한 데이터를 다루는 경우, **세션**이 더 안전하다. JWT는 클라이언트에 저장되므로 노출될 가능성이 있다.
- 그러나, HTTPS를 사용하고 토큰을 적절히 관리하면 JWT도 안전하게 사용할 수 있다.

### 3. **리프레시 토큰이 필요한가?**
- 리프레시 토큰을 통해 Access Token을 갱신해야 하는 경우, DB나 저장소를 활용해야 한다. 이 경우 JWT의 무상태성을 완전히 누릴 수 없으므로, 세션과의 차이가 줄어든다.
- 리프레시 토큰이 필요 없는 단순 인증 시스템이라면, JWT가 적합할 수 있다.

### 4. **클라이언트와 서버의 요청 빈도는?**
- 클라이언트 요청이 매우 빈번하다면, 세션은 서버 I/O를 증가시킬 수 있다. 이때 **JWT**가 유리하다.
- 요청 빈도가 낮고 민감 정보가 많다면 **세션**이 더 안전하다.

### 5. **구현의 간단함과 유지보수성은?**
- 빠르게 구현해야 하고, 확장이 중요한 경우 **JWT**가 적합하다.
- 복잡한 권한 관리가 필요하거나 상태를 저장해야 하는 경우, **세션**이 관리하기 더 쉽다.


## JWT와 세션 선택 사례

### 사례 1: 대규모 웹 애플리케이션
- 서버가 수십 대로 확장되고, 사용자가 많다.
- API 요청이 자주 발생하며, 인증 서버를 분리했다.
- **JWT를 선택**하여 서버 간 동기화 없이 확장성을 높인다.

### 사례 2: 민감한 금융 서비스
- 사용자가 적고, 데이터 보안이 최우선이다.
- 상태를 유지하며 세션 만료 정책을 세밀하게 관리한다.
- **세션을 선택**하여 민감한 정보가 클라이언트에 노출되지 않도록 한다.

### 사례 3: 단순한 블로그 서비스
- 서버가 1대, 또는 적은 규모로 운영된다.
- 복잡한 상태 관리가 필요 없다.
- **JWT를 선택**하여 빠르게 구현하고, 유지보수를 간소화한다.


## 결론
JWT와 세션은 환경에 따라 적합한 경우가 다르다. 중요한 것은 단순히 "JWT vs 세션"으로 선택하는 것이 아니라, 시스템의 요구사항에 따라 **확장성**, **보안성**, **구현의 복잡성**을 종합적으로 고려하는 것이다.

리프레시 토큰이 필요한 환경과 그렇지 않은 환경의 차이를 이해하고, 서버 확장성 및 보안 요구사항을 기준으로 선택하면 된다.


"리프레시 토큰이 필요 없는 환경도 있지 않을까"라는 말은 리프레시 토큰의 목적과 사용 사례를 되돌아보고, 그것이 반드시 모든 시스템에서 필요하지 않을 수 있다는 점을 생각해보라는 뜻이다. 리프레시 토큰은 보통 **Access Token의 짧은 유효기간**을 보완하기 위해 사용된다. 하지만 모든 애플리케이션에서 리프레시 토큰이 필요한 것은 아니다. 아래에서 리프레시 토큰이 필요하지 않은 환경을 몇 가지로 나눠 설명해본다.


### 1. **유효기간이 긴 Access Token을 사용할 수 있는 환경**
리프레시 토큰은 Access Token의 짧은 유효기간을 해결하기 위해 도입된다. 하지만 만약 Access Token의 유효기간을 길게 설정해도 문제가 없는 경우라면 리프레시 토큰은 필요 없다. 예를 들어:

- 애플리케이션이 보안에 민감하지 않고, 중요한 데이터를 다루지 않는 경우
- 사용자의 활동이 지속적이지 않고, 로그인 세션이 하루 이상 지속되어도 무방한 경우

이런 경우, 리프레시 토큰 없이 긴 유효기간의 Access Token만으로도 충분히 시스템이 운영될 수 있다.


### 2. **사용자 로그인이 자주 이루어지는 환경**
사용자들이 애플리케이션에 자주 로그인하거나, 로그인이 복잡하지 않은 경우라면 굳이 리프레시 토큰을 유지할 필요가 없다. 예를 들어:

- 일반적인 소셜 미디어 플랫폼이나 블로그 서비스
- 로그인 과정이 빠르고 단순한 애플리케이션

이 경우, Access Token이 만료되면 다시 로그인을 요청하는 방식으로 사용자 경험에 큰 문제가 생기지 않는다.


### 3. **높은 보안 요구사항으로 Access Token 만료 시 재로그인 필수**
금융 서비스나 민감한 데이터를 다루는 애플리케이션에서는 Access Token이 만료되면 사용자가 다시 로그인하도록 요구하기도 한다. 이 경우, 리프레시 토큰을 통해 자동으로 새 Access Token을 발급받는 메커니즘은 오히려 보안 리스크를 증가시킬 수 있다. 따라서 리프레시 토큰 없이 **재로그인**을 통해 인증을 갱신하는 방식을 채택하기도 한다.


### 4. **백엔드가 클라이언트의 상태를 지속적으로 확인하는 환경**
리프레시 토큰은 주로 클라이언트와 서버 간의 인증 상태를 비동기적으로 유지하기 위해 사용된다. 하지만 특정 환경에서는 클라이언트의 상태를 서버가 실시간으로 확인하거나, 상태를 수시로 동기화할 수 있다. 예를 들어:

- 클라이언트-서버 간의 연결이 지속적으로 유지되는 애플리케이션(예: 실시간 게임 서버)
- 사용자 세션을 명시적으로 관리하는 시스템

이런 경우 리프레시 토큰이 불필요하며, Access Token만으로 충분히 인증 상태를 유지할 수 있다.


### 5. **1회성 인증만 필요한 시스템**
일부 시스템에서는 사용자 인증이 한 번 이루어진 후, 별도의 세션 유지가 필요 없을 수 있다. 예를 들어:

- API 호출이 한 번만 이루어지는 서비스(예: 단순 데이터 조회 API)
- 사용자가 주기적으로 인증하는 대신, 별도의 세션 상태를 유지하지 않는 시스템

이 경우 Access Token을 짧게 설정해도 무방하며, 리프레시 토큰은 불필요하다.



참고
[jwt 보다 session이 안전할까? 🤔](https://github.com/boojongmin/memo/issues/7)
[인증 방식 선택에 대한 고민과 고찰 (Session vs Token)](https://farmfarm1223.tistory.com/105)