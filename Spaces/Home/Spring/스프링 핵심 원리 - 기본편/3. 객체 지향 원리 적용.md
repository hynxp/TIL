## π“ μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°
μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ ν™•μ¥ν•΄λ³΄μ.

κ³ μ • κΈμ•΅ ν• μΈμ΄ μ•„λ‹λΌ μΆ€ λ” ν•©λ¦¬μ μΈ μ£Όλ¬Έ κΈμ•΅λ‹Ή ν• μΈν•λ” μ •λ¥  % ν• μΈμΌλ΅ λ³€κ²½ν•΄λ³΄μ. 
μλ¥Ό λ“¤μ–΄μ„ κΈ°μ΅΄ μ •μ±…μ€ VIPκ°€ 10000μ›μ„ μ£Όλ¬Έν•λ“  20000μ›μ„ μ£Όλ¬Έν•λ“  ν•­μƒ 1000μ›μ„ ν• μΈν–λ”λ°, μ΄λ²μ— μƒλ΅ λ‚μ¨ μ •μ±…μ€ 10%λ΅ μ§€μ •ν•΄λ‘λ©΄ κ³ κ°μ΄ 10000μ› μ£Όλ¬Έμ‹ 1000μ›μ„ ν• μΈν•΄μ£Όκ³ , 20000μ› μ£Όλ¬Έμ‹μ— 2000μ›μ„ ν• μΈν•΄μ£Όλ” μ‹μ΄λ‹¤.

### ν• μΈ λ„λ©”μΈ ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨
![|500](https://blog.kakaocdn.net/dn/cSOPIQ/btrCIGrkreg/u7zA2kTUbsrdgkGvFT1UyK/img.png)



`DiscountPolicy`Β μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” μƒλ΅μ΄ ν΄λμ¤Β `RateDiscountPolicy`λ¥Ό μƒμ„±ν•μ—¬ μ•„λμ™€ κ°™μ΄ κµ¬ν„ν•λ‹¤.
```java
public class RateDiscountPolicy implements DiscountPolicy{

    private int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if(member.getGrade() == Grade.VIP)
            return price * discountPercent / 100;
        else return 0;
    }
}
```

μ΄ν›„ ν…μ¤νΈλ¥Ό μ„ν•΄ μ•„λμ™€ κ°™μ΄ ν…μ¤νΈ ν΄λμ¤λ¥Ό κµ¬ν„ν•κ³  μ‹¤ν–‰ν•λ‹¤.
```java
class RateCountPolicyTest {

    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIPλ” 10% ν• μΈμ΄ μ μ©λμ–΄μ•Ό ν•λ‹¤.")
    void vip_o(){
        //given
        Member member = new Member(1L, "memberVIP", Grade.VIP);

        //when
        int discount = discountPolicy.discount(member, 10000);

        //then
        Assertions.assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPκ°€ μ•„λ‹λ©΄ 10% ν• μΈμ΄ μ μ©λμ§€ μ•μ•„μ•Ό ν•λ‹¤.")
    void vip_x(){
        //given
        Member member = new Member(2L, "memberBASIC", Grade.BASIC);

        //when
        int discount = discountPolicy.discount(member, 10000);

        //then
        Assertions.assertThat(discount).isEqualTo(0);
    }
}
```

> Windowsμ κ²½μ° Ctrl + Shift + T λ‹¨μ¶•ν‚¤λ¥Ό ν†µν•΄ μ†μ‰½κ² ν…μ¤νΈ ν΄λμ¤λ¥Ό μƒμ„±ν•  μ μλ‹¤.



## π“ μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 
λ°©κΈ μ¶”κ°€ν• ν• μΈ μ •μ±…μ„ μ μ©ν•΄λ³΄μ.

ν• μΈ μ •μ±…μ„ λ³€κ²½ν•λ ¤λ©΄ ν΄λΌμ΄μ–ΈνΈμΈΒ `OrderServiceImpl`Β μ½”λ“λ¥Ό κ³ μ³μ•Ό ν•λ‹¤.
```java
public class OrderServiceImpl implements OrderService {

    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

}
```

### π“ λ¬Έμ μ  λ°κ²¬
#### μ°λ¦¬λ” μ—­ν• κ³Ό κµ¬ν„μ„ μ¶©μ‹¤ν•κ² λ¶„λ¦¬ν–λ‹¤. -> OK

#### λ‹¤ν•μ„±λ„ ν™μ©ν•κ³ , μΈν„°νμ΄μ¤μ™€ κµ¬ν„ κ°μ²΄λ¥Ό λ¶„λ¦¬ν–λ‹¤. -> OK

#### OCP, DIP κ°™μ€ κ°μ²΄μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ¶©μ‹¤ν μ¤€μν–λ‹¤ -> κ·Έλ ‡κ² λ³΄μ΄μ§€λ§ μ‚¬μ‹¤μ€ μ•„λ‹λ‹¤.

#### DIP μ£Όλ¬Έμ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈ(`OrderServiceImpl`)λ”Β `DiscountPolicy`Β μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ©΄μ„ DIPλ¥Ό μ§€ν‚¨ κ²ƒ κ°™μ€λ°?
ν΄λμ¤ μμ΅΄κ΄€κ³„λ¥Ό λ¶„μ„ν•΄λ³΄μ. μ¶”μƒ(μΈν„°νμ΄μ¤) λΏλ§ μ•„λ‹λΌ κµ¬μ²΄(κµ¬ν„) ν΄λμ¤μ—λ„ μμ΅΄ν•κ³  μλ‹¤.
- μ¶”μƒ(μΈν„°νμ΄μ¤) μμ΅΄ :Β `DiscountPolicy`
- κµ¬μ²΄(κµ¬ν„) ν΄λμ¤ :Β `FixDiscountPolicy`,Β `RateDiscountPolicy

#### OCP: λ³€κ²½ν•μ§€ μ•κ³  ν™•μ¥ν•  μ μλ‹¤κ³  ν–λ”λ°!
- μ§€κΈ μ½”λ“λ” κΈ°λ¥μ„ ν™•μ¥ν•΄μ„ λ³€κ²½ν•λ©΄, ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μν–¥μ„ μ¤€λ‹¤! λ”°λΌμ„ OCPλ¥Ό μ„λ°ν•λ‹¤.


### μ™ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•΄μ•Ό ν• κΉ?
ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨μΌλ΅ μμ΅΄κ΄€κ³„λ¥Ό λ¶„μ„ν•΄λ³΄μ.

#### κΈ°λ€ν–λ μμ΅΄κ΄€κ³„
![|500](https://blog.kakaocdn.net/dn/l5kLV/btrCMXLpDfc/vkHbAUluGiWopUTiVCHDkk/img.png)

μ§€κΈκΉμ§€ λ‹¨μνΒ `DiscountPolicy`Β μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ‹¤κ³  μƒκ°ν–λ‹¤.

#### μ‹¤μ  μμ΅΄κ΄€κ³„
![|500](https://blog.kakaocdn.net/dn/b3fuI9/btrCIms7FJz/cfwNgaddhc1uivjzEeBT90/img.png)

ν•μ§€λ§ ν΄λΌμ΄μ–ΈνΈμΈΒ `OrderServiceImpl`μ΄Β `DiscountPolicy`Β μΈν„°νμ΄μ¤ λΏλ§ μ•„λ‹λΌΒ 
`FixDiscountPolicy`μΈ κµ¬μ²΄ ν΄λμ¤λ„ ν•¨κ» μμ΅΄ν•κ³  μλ‹¤. μ‹¤μ  μ½”λ“λ¥Ό λ³΄λ©΄ μμ΅΄ν•κ³  μλ‹¤! 
->Β **DIP μ„λ°**
#### μ •μ±… λ³€κ²½

![|500](https://blog.kakaocdn.net/dn/VaT76/btrCKju5WYu/mI5cG8HLXtyxH8kZCTOWBk/img.png)
**μ¤‘μ”!**Β : κ·Έλμ„Β `FixDiscountPolicy`λ¥ΌΒ `RateDiscountPolicy`λ΅ λ³€κ²½ν•λ” μκ°„Β `OrderServiceImpl`μ μ†μ¤ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν•λ‹¤! ->Β **OCP μ„λ°**


### κ·Έλ ‡λ‹¤λ©΄ μ–΄λ–»κ² λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μμ„κΉ?
DIPλ¥Ό μ„λ°ν•μ§€ μ•λ„λ΅ μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μμ΅΄κ΄€κ³„λ¥Ό λ³€κ²½ν•λ©΄ λλ‹¤.

#### μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„λ¥Ό λ³€κ²½ν•μ

![|500](https://blog.kakaocdn.net/dn/bXMRVg/btrCLApEeCw/NOdWm3bkhxaPP2eBT1kYUk/img.png)



#### μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“ λ³€κ²½
```java
public class OrderServiceImpl implements OrderService {

    //private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
    private DiscountPolicy discountPolicy;

}
```
μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„μ™€ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤. κ·Έλ°λ° κµ¬ν„μ²΄κ°€ μ—†λ”λ° μ–΄λ–»κ² μ½”λ“λ¥Ό μ‹¤ν–‰ν•  μ μμ„κΉ?

μ‹¤μ  μ‹¤ν–‰μ„ ν•΄λ³΄λ©΄ NPE(Null Pointer Exception)κ°€ λ°μƒν•λ‹¤.

#### ν•΄κ²°λ°©μ•
μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ ¤λ©΄ λ„κµ°κ°€κ°€ ν΄λΌμ΄μ–ΈνΈμΈΒ `OrderServiceImpl`μ—Β `DiscountPolicy`μ κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.



## π“ κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬
μ• ν”λ¦¬μΌ€μ΄μ…μ„ ν•λ‚μ κ³µμ—°μ΄λΌ μƒκ°ν•΄λ³΄μ. κ°κ°μ μΈν„°νμ΄μ¤λ¥Ό λ°°μ—­(λ°°μ° μ—­ν• )μ΄λΌ μƒκ°ν•μ. κ·Έλ°λ°! μ‹¤μ  λ°°μ—­ λ§λ” λ°°μ°λ¥Ό μ„ νƒν•λ” κ²ƒμ€ λ„κ°€ ν•λ”κ°€?

λ΅λ―Έμ¤μ™€ μ¤„λ¦¬μ—£ κ³µμ—°μ„ ν•λ©΄ λ΅λ―Έμ¤ μ—­ν• μ„ λ„κ°€ ν• μ§€ μ¤„λ¦¬μ—£ μ—­ν• μ„ λ„κ°€ ν• μ§€λ” λ°°μ°λ“¤μ΄ μ •ν•λ”κ² μ•„λ‹λ‹¤.

μ΄μ „ μ½”λ“λ” λ§μΉ λ΅λ―Έμ¤ μ—­ν• (μΈν„°νμ΄μ¤)μ„ ν•λ” λ μ¤λ‚λ¥΄λ„ λ””μΉ΄ν”„λ¦¬μ¤(κµ¬ν„μ²΄, λ°°μ°)κ°€ μ¤„λ¦¬μ—£ μ—­ν• (μΈν„°νμ΄μ¤)μ„ ν•λ” μ—¬μ μ£ΌμΈκ³µ(κµ¬ν„μ²΄, λ°°μ°)μ„ μ§μ ‘ μ΄λΉ™ν•λ” κ²ƒκ³Ό κ°™λ‹¤. λ””μΉ΄ν”„λ¦¬μ¤λ” κ³µμ—°λ„ ν•΄μ•Όν•κ³  λ™μ‹μ— μ—¬μ μ£ΌμΈκ³µλ„ κ³µμ—°μ— μ§μ ‘ μ΄λΉ™ν•΄μ•Ό ν•λ”Β **λ‹¤μ–‘ν• μ±…μ„**μ„ κ°€μ§€κ³  μλ‹¤.

### κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ
- λ°°μ°λ” λ³ΈμΈμ μ—­ν• μΈ λ°°μ—­μ„ μν–‰ν•λ” κ²ƒμ—λ§ μ§‘μ¤‘ν•΄μ•Ό ν•λ‹¤.
- λ””μΉ΄ν”„λ¦¬μ¤λ” μ–΄λ–¤ μ—¬μ μ£ΌμΈκ³µμ΄ μ„ νƒλλ”λΌλ„ λ‘κ°™μ΄ κ³µμ—°μ„ ν•  μ μμ–΄μ•Ό ν•λ‹¤.
- κ³µμ—°μ„ κµ¬μ„±ν•κ³ , λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„­μ™Έν•κ³ , μ—­ν• μ— λ§λ” λ°°μ°λ¥Ό μ§€μ •ν•λ” μ±…μ„μ„ λ‹΄λ‹Ήν•λ” λ³„λ„μ κ³µμ—° κΈ°νμκ°€ λ‚μ¬μ‹μ μ΄λ‹¤.
- κ³µμ—° κΈ°νμλ¥Ό λ§λ“¤κ³ , λ°°μ°μ™€ κ³µμ—° κΈ°νμμ μ±…μ„μ„ ν™•μ‹¤ν λ¶„λ¦¬ν•μ.


### π“ AppConfig λ“±μ¥
μ• ν”λ¦¬μΌ€μ΄μ…μ μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±(config)ν•κΈ° μ„ν•΄, κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•λ” μ±…μ„μ„ κ°€μ§€λ” λ³„λ„μ μ„¤μ • ν΄λμ¤λ¥Ό λ§λ“¤μ.

`AppConfig`Β ν΄λμ¤λ¥Ό μƒμ„±ν•κ³  λ‹¤μκ³Ό κ°™μ΄ κµ¬ν„ν•λ‹¤.
```java
public class AppConfig {

    public MemberService memberService(){
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService(){
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
    }
}
```

#### `AppConfig`λ” μ• ν”λ¦¬μΌ€μ΄μ…μ μ‹¤μ  λ™μ‘μ— ν•„μ”ν• κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•λ‹¤.
- `MemberServiceImpl`
- `MemoryMemberRepository`
- `OrderServiceImpl`
- `FixDiscountPolicy`

#### `AppConfig`λ” μƒμ„±ν• κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°(λ νΌλ°μ¤)λ¥Ό μƒμ„±μλ¥Ό ν†µν•΄μ„ μ£Όμ…(μ—°κ²°)ν•΄μ¤€λ‹¤.
- `MemberServiceImpl` -> `MemoryMemberRepository`
- `OrderServiceImpl` -> `MemoryMemberRepository`, `FixDiscountPolicy`

> μ°Έκ³ λ΅ μ§€κΈμ€ κ° ν΄λμ¤μ— μƒμ„±μκ°€ μ—†μ–΄μ„ μ»΄νμΌ μ¤λ¥κ°€ λ°μƒν•λ‹¤. λ°”λ΅ λ‹¤μμ— μ½”λ“μ—μ„ μƒμ„±μλ¥Ό λ§λ“ λ‹¤.


```java
public class MemberServiceImpl implements MemberService{

    private final MemberRepository memberRepository;

    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
}
```
- μ„¤κ³„ λ³€κ²½μΌλ΅Β `MemberServiceImpl`μ€Β `MemoryMemberRepository`λ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤! λ‹¨μ§€Β `MemberRepository`Β μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ‹¤.

-Β `MemberServiceImpl`Β μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€(μ£Όμ…λ μ§€)λ” μ• μ μ—†λ‹¤.  
-Β `MemberServiceImpl`μ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ¥Ό μ£Όμ…ν• μ§€λ” μ¤μ§ μ™Έλ¶€(`AppConfig`)μ—μ„ κ²°μ •λλ‹¤.  
-Β `MemberServiceImpl`μ€ μ΄μ λ¶€ν„° μμ΅΄κ΄€κ³„μ— λ€ν• κ³ λ―Όμ€ μ™Έλ¶€μ— λ§΅κΈ°κ³  μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•λ©΄ λλ‹¤.

### ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨
![|500](https://blog.kakaocdn.net/dn/wtbUK/btrCJuDVUr2/tT8C0xEwlyOqK4QKXuNb6K/img.png)
κ°μ²΄μ μƒμ„±κ³Ό μ—°κ²°μ€Β `AppConfig`κ°€ λ‹΄λ‹Ήν•λ‹¤.
#### DIP μ™„μ„±
`MemberServiceImpl`μ€ `MemberRepository`μΈ μ¶”μƒμ—λ§ μμ΅΄ν•λ©΄ λλ‹¤. μ΄μ  κµ¬μ²΄ ν΄λμ¤λ¥Ό λ°λΌλ„ λλ‹¤.

#### κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬
κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν• κ³Ό μ‹¤ν–‰ν•λ” μ—­ν• μ΄ λ…ν™•ν λ¶„λ¦¬λμ—λ‹¤.

### νμ› κ°μ²΄ μΈμ¤ν„΄μ¤ λ‹¤μ΄μ–΄κ·Έλ¨

![|500](https://blog.kakaocdn.net/dn/A5RoM/btrCMYwOwzq/gemIFu0j7mebNhY5tKcNj0/img.png)

`appConfig`Β κ°μ²΄λ”Β `memoryMemberRepository`Β κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ·Έ μ°Έμ΅°κ°’μ„Β `memberServiceImpl`μ„ μƒμ„±ν•λ©΄μ„ μƒμ„±μλ΅ μ „λ‹¬ν•λ‹¤.

  ν΄λΌμ΄μ–ΈνΈμΈΒ `memberServiceImpl`Β μ…μ¥μ—μ„ λ³΄λ©΄ μμ΅΄κ΄€κ³„λ¥Ό λ§μΉ μ™Έλ¶€μ—μ„ μ£Όμ…ν•΄μ£Όλ” κ²ƒ κ°™λ‹¤κ³  ν•΄μ„ DI(Dependency Injection) μ°λ¦¬λ§λ΅ μμ΅΄κ΄€κ³„ μ£Όμ… λλ” μμ΅΄μ„± μ£Όμ…μ΄λΌ ν•λ‹¤.


### `OrderServiceImpl`Β - μƒμ„±μ μ£Όμ…
```java
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```
μ„¤κ³„ λ³€κ²½μΌλ΅Β `OrderServiceImpl`μ€Β `FixDiscountPolicy`λ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤! 
λ‹¨μ§€Β `DiscountPolicy`Β μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ‹¤.

- `OrderServiceImpl`Β μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€(μ£Όμ…λ μ§€)λ” μ• μ μ—†λ‹¤.
- `OrderServiceImpl`μ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄μ„ μ£Όμ…ν• μ§€λ” μ¤μ§ μ™Έλ¶€(`AppConfig`)μ—μ„  
    κ²°μ •ν•λ‹¤.
- `OrderServiceImpl`μ€ μ΄μ λ¶€ν„° μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•λ©΄ λλ‹¤.
- `OrderServiceImpl`μ—λ”Β `MemoryMemberRepository`,Β `FixDiscountPolicy`Β κ°μ²΄μ μμ΅΄κ΄€κ³„κ°€  
    μ£Όμ…λλ‹¤.


### π“ AppConfig μ‹¤ν–‰
μ΄μ  μ„μ—μ„ μ‘μ„±ν•Β `AppConfig`Β ν΄λμ¤λ¥Ό ν™μ©ν•΄λ³΄μ.

#### μ‚¬μ© ν΄λμ¤ -Β `MemberApp`
```java
public class MemberApp {

    public static void main(String[] args){
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member = " + member.getName());
        System.out.println("find member = " + findMember.getName());
    }
}
```

#### μ‚¬μ© ν΄λμ¤ -Β `OrderApp`
```java
public class OrderApp {

    public static void main(String[] args){
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        OrderService orderService = appConfig.orderService();

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);

        System.out.println("order = " + order.toString());
    }
}
```

#### ν…μ¤νΈ μ½”λ“ μ¤λ¥ μμ •
```java
public class MemberServiceTest {

    MemberService memberService;

    @BeforeEach
    public void beforeEach(){
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
    }

    @Test
    void join(){
        //given
        Member member = new Member(1L, "memberA", Grade.VIP);

        //when
        memberService.join(member);
        Member findMember = memberService.findMember(1L);

        //then
        Assertions.assertThat(member).isEqualTo(findMember);
    }
}
```

```java
public class OrderServiceTest {

    MemberService memberService;
    OrderService orderService;

    @BeforeEach
    public void beforeEach(){
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
        orderService = appConfig.orderService();
    }

    @Test
    void createOrder(){
        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }
}
```
ν…μ¤νΈ μ½”λ“μ—μ„Β `@BeforeEach`λ” κ° ν…μ¤νΈλ¥Ό μ‹¤ν–‰ν•κΈ° μ „μ— νΈμ¶λλ‹¤.

μ„ λ‚΄μ©λ“¤μ„ μ •λ¦¬ν•μλ©΄ λ‹¤μκ³Ό κ°™λ‹¤.
- μ°λ¦¬λ”Β `AppConfig`λ¥Ό ν†µν•΄μ„ κ΄€μ‹¬μ‚¬λ¥Ό ν™•μ‹¤ν•κ² λ¶„λ¦¬ν–λ‹¤.
- λ°°μ—­, λ°°μ°λ¥Ό μƒκ°ν•΄λ³΄μ.
- `AppConfig`λ” κ³µμ—° κΈ°νμλ‹¤.
- `AppConfig`λ” κµ¬μ²΄ ν΄λμ¤λ¥Ό μ„ νƒν•λ‹¤. λ°°μ—­μ— λ§λ” λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„ νƒν•λ‹¤. μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ–΄λ–»κ² λ™μ‘ν•΄μ•Ό ν• μ§€ μ „μ²΄ κµ¬μ„±μ„ μ±…μ„μ§„λ‹¤.
- μ΄μ  κ° λ°°μ°λ“¤μ€ λ‹΄λ‹Ή κΈ°λ¥μ„ μ‹¤ν–‰ν•λ” μ±…μ„λ§ μ§€λ©΄ λλ‹¤.
- `OrderServiceImpl`μ€ κΈ°λ¥μ„ μ‹¤ν–‰ν•λ” μ±…μ„λ§ μ§€λ©΄ λλ‹¤.



## π“ AppConfig λ¦¬ν©ν„°λ§
ν„μ¬Β `AppConfig`λ¥Ό λ³΄λ©΄ μ¤‘λ³µμ΄ μκ³ , μ—­ν• μ— λ”°λ¥Έ κµ¬ν„μ΄ μ μ•λ³΄μΈλ‹¤.

### κΈ°λ€ν•λ” κ·Έλ¦Ό

![|500](https://blog.kakaocdn.net/dn/sSM4l/btrCMYwPEg7/KGeKtBJz3DEbuKvEF3LWak/img.png)



### λ¦¬ν©ν† λ§ μ „
```java
public class AppConfig {

    public MemberService memberService(){
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService(){
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
    }
}
```
μ„ μ½”λ“μ—μ„ μ¤‘λ³µμ„ μ κ±°ν•κ³ , μ—­ν• μ— λ”°λ¥Έ κµ¬ν„μ΄ λ³΄μ΄λ„λ΅ λ¦¬ν©ν„°λ§ ν•΄λ³΄μ.

### λ¦¬ν©ν† λ§ ν›„
```java
public class AppConfig {

    public MemberService memberService(){
        return new MemberServiceImpl(memberRepository());
    }

    public MemberRepository memberRepository(){
        return new MemoryMemberRepository();
    }

    public OrderService orderService(){
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy(){
        return new FixDiscountPolicy();
    }
}
```
`new MemoryMemberRepository()`Β λ¶€λ¶„μ΄ μ¤‘λ³µ μ κ±°λμ—λ‹¤. μ΄μ Β `MemoryMemberRepository`λ¥Ό λ‹¤λ¥Έ κµ¬ν„μ²΄λ΅ λ³€κ²½ν•  λ• ν• λ¶€λ¶„λ§ λ³€κ²½ν•λ©΄ λλ‹¤.

`AppConfig`λ¥Ό λ³΄λ©΄ μ—­ν• κ³Ό κµ¬ν„ ν΄λμ¤κ°€ ν•λμ— λ“¤μ–΄μ¨λ‹¤. μ• ν”λ¦¬μΌ€μ΄μ… μ „μ²΄ κµ¬μ„±μ΄ μ–΄λ–»κ² λμ–΄μλ”μ§€ λΉ λ¥΄κ² νμ•…ν•  μ μλ‹¤.



## π“ μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©
μ²μμΌλ΅ λμ•„κ°€μ„ μ •μ•΅ ν• μΈ μ •μ±…μ„ μ •λ¥  ν• μΈ μ •μ±…μΌλ΅ λ³€κ²½ν•΄λ³΄μ. 
(`FixDiscountPolicy`Β ->Β `RateDiscountPolicy`)

μ–΄λ–¤ λ¶€λ¶„λ§ λ³€κ²½ν•λ©΄ λκ² λ”κ°€?

`AppConfig`μ λ“±μ¥μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν¬κ² μ‚¬μ© μμ—­κ³Ό, κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κµ¬μ„±(Configuration)ν•λ” μμ—­μΌλ΅ λ¶„λ¦¬λμ—λ‹¤.

### μ‚¬μ©, κµ¬μ„±μ λ¶„λ¦¬

![|500](https://blog.kakaocdn.net/dn/SjZRw/btrCJUbpCgd/kc426WN4VME0vN0hk0JHSk/img.png)

### ν• μΈ μ •μ±…μ λ³€κ²½
![|500](https://blog.kakaocdn.net/dn/skdL0/btrCJKswhGa/yKy8qTxPc2R93390WCGzkk/img.png)
`FixDiscountPolicy`Β ->Β `RateDiscountPolicy`λ΅ λ³€κ²½ν•΄λ„ κµ¬μ„± μμ—­λ§ μν–¥μ„ λ°›κ³ , μ‚¬μ© μμ—­μ€ μ „ν€ μν–¥μ„ λ°›μ§€ μ•λ”λ‹¤.

### ν• μΈ μ •μ±… λ³€κ²½ κµ¬μ„± μ½”λ“
```java
public class AppConfig {

    private DiscountPolicy discountPolicy(){
        //return new FixDiscountPolicy();
        return new RateDiscountPolicy();
    }
}
```
`AppConfig`μ—μ„ ν• μΈ μ •μ±… μ—­ν• μ„ λ‹΄λ‹Ήν•λ” κµ¬ν„μ„Β `FixDiscountPolicy`μ—μ„Β `RateDiscountPolicy`Β κ°μ²΄λ΅ λ³€κ²½ν–λ‹¤.

  μ΄μ  ν• μΈ μ •μ±…μ„ λ³€κ²½ν•΄λ„, μ• ν”λ¦¬μΌ€μ΄μ…μ κµ¬μ„± μ—­ν• μ„ λ‹΄λ‹Ήν•λ”Β `AppConfig`λ§ λ³€κ²½ν•λ©΄ λλ‹¤. ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈΒ `OrderServiceImpl`μ„ ν¬ν•¨ν•΄μ„Β **μ‚¬μ© μμ—­**μ μ–΄λ–¤ μ½”λ“λ„ λ³€κ²½ν•  ν•„μ”κ°€ μ—†λ‹¤.

**κµ¬μ„± μμ—­**μ€ λ‹Ήμ—°ν λ³€κ²½λλ‹¤. κµ¬μ„± μ—­ν• μ„ λ‹΄λ‹Ήν•λ”Β `AppConfig`λ¥Ό μ• ν”λ¦¬μΌ€μ΄μ…μ΄λΌλ” κ³µμ—°μ κΈ°νμλ΅ μƒκ°ν•μ. κ³µμ—° κΈ°νμλ” κ³µμ—° μ°Έμ—¬μμΈ κµ¬ν„ κ°μ²΄λ“¤μ„ λ¨λ‘ μ•μ•„μ•Ό ν•λ‹¤.


## π“ μ „μ²΄ νλ¦„ μ •λ¦¬
μ§€κΈκΉμ§€μ νλ¦„μ„ μ •λ¦¬ν•΄λ³΄μ.

- μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°
- μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 
- κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬
- `AppConfig`Β λ¦¬ν©ν„°λ§
- μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©


### π“ μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°
- λ‹¤ν•μ„± λ•λ¶„μ— μƒλ΅μ΄ μ •λ¥  ν• μΈ μ •μ±… μ½”λ“λ¥Ό μ¶”κ°€λ΅ κ°λ°ν•λ” κ²ƒ μμ²΄λ” μ•„λ¬΄ λ¬Έμ κ°€ μ—†μ


### π“ μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 
- μƒλ΅ κ°λ°ν• μ •λ¥  ν• μΈ μ •μ±…μ„ μ μ©ν•λ ¤κ³  ν•λ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈ μ£Όλ¬Έ μ„λΉ„μ¤ κµ¬ν„μ²΄λ„ ν•¨κ» λ³€κ²½ν•΄μ•Όν•¨
- μ£Όλ¬Έ μ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈκ°€ μΈν„°νμ΄μ¤μΈΒ `DiscountPolicy`Β λΏλ§ μ•„λ‹λΌ, κµ¬μ²΄ ν΄λμ¤μΈΒ `FixDiscountPolicy`λ„ ν•¨κ» μμ΅΄ ->Β **DIP μ„λ°**


### π“ κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬
- μ• ν”λ¦¬μΌ€μ΄μ…μ„ ν•λ‚μ κ³µμ—°μΌλ΅ μƒκ°
- κΈ°μ΅΄μ—λ” ν΄λΌμ΄μ–ΈνΈκ°€ μμ΅΄ν•λ” μ„λ²„ κµ¬ν„ κ°μ²΄λ¥Ό μ§μ ‘ μƒμ„±ν•κ³ , μ‹¤ν–‰ν•¨
- λΉ„μ λ¥Ό ν•λ©΄ κΈ°μ΅΄μ—λ” λ‚¨μ μ£ΌμΈκ³µ λ°°μ°κ°€ κ³µμ—°λ„ ν•κ³ , λ™μ‹μ— μ—¬μ μ£ΌμΈκ³µλ„ μ§μ ‘ μ΄λΉ™ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μμ
- κ³µμ—°μ„ κµ¬μ„±ν•κ³ , λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„­μ™Έν•κ³ , μ§€μ •ν•λ” μ±…μ„μ„ λ‹΄λ‹Ήν•λ” λ³„λ„μ κ³µμ—° κΈ°νμκ°€ λ‚μ¬ μ‹μ 
- κ³µμ—° κΈ°νμμΈΒ `AppConfig`κ°€ λ“±μ¥
- `AppConfig`λ” μ• ν”λ¦¬μΌ€μ΄μ…μ μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±(config)ν•κΈ° μ„ν•΄, κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•λ” μ±…μ„
- μ΄μ λ¶€ν„° ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μμ‹ μ μ—­ν• μ„ μ‹¤ν–‰ν•λ” κ²ƒλ§ μ§‘μ¤‘, κ¶ν•μ΄ μ¤„μ–΄λ“¬(μ±…μ„μ΄ λ…ν™•ν•΄μ§)


#### π“ AppConfig λ¦¬ν©ν„°λ§
- κµ¬μ„± μ •λ³΄μ—μ„ μ—­ν• κ³Ό κµ¬ν„μ„ λ…ν™•ν•κ² λ¶„λ¦¬
- μ—­ν• μ΄ μ λ“λ¬λ‚¨
- μ¤‘λ³µ μ κ±°


### π“ μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©
- μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©
- μ •μ•΅ ν• μΈ μ •μ±… -> μ •λ¥  ν• μΈ μ •μ±…μΌλ΅ λ³€κ²½
- `AppConfig`μ λ“±μ¥μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν¬κ² μ‚¬μ© μμ—­κ³Ό, κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κµ¬μ„±(Configuration)ν•λ” μμ—­μΌλ΅ λ¶„λ¦¬
- ν• μΈ μ •μ±…μ„ λ³€κ²½ν•΄λ„Β `AppConfig`κ°€ μλ” κµ¬μ„± μμ—­λ§ λ³€κ²½ν•λ©΄ λ¨, μ‚¬μ© μμ—­μ€ λ³€κ²½ν•  ν•„μ”κ°€ μ—†μ. λ¬Όλ΅  ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈ μ£Όλ¬Έ μ„λΉ„μ¤ μ½”λ“λ„ λ³€κ²½ν•μ§€ μ•μ



## π“ μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™μ μ μ©
μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ μ›μΉ™ 5κ°€μ§€ μ¤‘ μ—¬κΈ°μ„λ” 3κ°€μ§€ μ›μΉ™μΌλ΅Β **SRP, DIP, OCP**Β μ μ©

### π“ SRP λ‹¨μΌ μ±…μ„ μ›μΉ™
**ν• ν΄λμ¤λ” ν•λ‚μ μ±…μ„λ§ κ°€μ Έμ•Ό ν•λ‹¤.**
- ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ§μ ‘ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μμ
- SRP λ‹¨μΌ μ±…μ„ μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•¨
- κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ±…μ„μ€Β `AppConfig`κ°€ λ‹΄λ‹Ή
- ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ‹¤ν–‰ν•λ” μ±…μ„λ§ λ‹΄λ‹Ή


### π“ DIP μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™
**ν”„λ΅κ·Έλλ¨Έλ” β€μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤.β€ μμ΅΄μ„± μ£Όμ…μ€ μ΄ μ›μΉ™μ„ λ”°λ¥΄λ” λ°©λ²• μ¤‘ ν•λ‚λ‹¤.**
- μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ κ°λ°ν•κ³ , μ μ©ν•λ ¤κ³  ν•λ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν–λ‹¤. μ™λƒν•λ©΄ κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“(`OrderServiceImpl`)λ” DIPλ¥Ό μ§€ν‚¤λ©°Β `DiscountPolicy`Β μ¶”μƒν™” μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ” κ²ƒ κ°™μ•μ§€λ§,Β `FixDiscountPolicy`Β κµ¬μ²΄ν™” κµ¬ν„ ν΄λμ¤μ—λ„ ν•¨κ» μμ΅΄ν–λ‹¤.
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€Β `DiscountPolicy`Β μ¶”μƒν™” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤.
- ν•μ§€λ§ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μΈν„°νμ΄μ¤λ§μΌλ΅λ” μ•„λ¬΄κ²ƒλ„ μ‹¤ν–‰ν•  μ μ—†λ‹¤.
- `AppConfig`κ°€Β `FixDiscountPolicy`Β κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ€μ‹  μƒμ„±ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν–λ‹¤. μ΄λ ‡κ²ν•΄μ„ DIP μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ λ¬Έμ λ„ ν•΄κ²°ν–λ‹¤.


### π“ OCP
**μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤**
- λ‹¤ν•μ„± μ‚¬μ©ν•κ³  ν΄λΌμ΄μ–ΈνΈκ°€ DIPλ¥Ό μ§€ν‚΄
- μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­μΌλ΅ λ‚λ”
- `AppConfig`κ°€ μμ΅΄κ΄€κ³„λ¥ΌΒ `FixDiscountPolicy`Β ->Β `RateDiscountPolicy`λ΅ λ³€κ²½ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μ£Όμ…ν•λ―€λ΅ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ³€κ²½ν•μ§€ μ•μ•„λ„ λ¨
- **μ†ν”„νΈμ›¨μ–΄ μ”μ†λ¥Ό μƒλ΅­κ² ν™•μ¥ν•΄λ„ μ‚¬μ© μμ—­μ λ³€κ²½μ€ λ‹«ν€ μλ‹¤!**



## π“ IoC, DI κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„
### π“ μ μ–΄μ μ—­μ „ IoC(Inversion of Control)
- κΈ°μ΅΄ ν”„λ΅κ·Έλ¨μ€ ν΄λΌμ΄μ–ΈνΈ κµ¬ν„ κ°μ²΄κ°€ μ¤μ¤λ΅ ν•„μ”ν• μ„λ²„ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν–λ‹¤. ν•λ§λ””λ΅ κµ¬ν„ κ°μ²΄κ°€ ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ μ¤μ¤λ΅ μ΅°μΆ…ν–λ‹¤. κ°λ°μ μ…μ¥μ—μ„λ” μμ—°μ¤λ¬μ΄ νλ¦„μ΄λ‹¤.
- λ°λ©΄μ—Β `AppConfig`κ°€ λ“±μ¥ν• μ΄ν›„μ— κµ¬ν„ κ°μ²΄λ” μμ‹ μ λ΅μ§μ„ μ‹¤ν–‰ν•λ” μ—­ν• λ§ λ‹΄λ‹Ήν•λ‹¤. ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ€ μ΄μ Β `AppConfig`κ°€ κ°€μ Έκ°„λ‹¤. μλ¥Ό λ“¤μ–΄μ„Β `OrderServiceImpl`μ€ ν•„μ”ν• μΈν„°νμ΄μ¤λ“¤μ„ νΈμ¶ν•μ§€λ§ μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ“¤μ΄ μ‹¤ν–‰λ μ§€ λ¨λ¥Έλ‹¤.
- ν”„λ΅κ·Έλ¨μ— λ€ν• μ μ–΄ νλ¦„μ— λ€ν• κ¶ν•μ€ λ¨λ‘Β `AppConfig`κ°€ κ°€μ§€κ³  μλ‹¤. μ‹¬μ§€μ–΄Β `OrderServiceImpl`λ„Β `AppConfig`κ°€ μƒμ„±ν•λ‹¤. κ·Έλ¦¬κ³ Β `AppConfig`λ”Β `OrderServiceImpl`μ΄ μ•„λ‹Β `OrderService`Β μΈν„°νμ΄μ¤μ λ‹¤λ¥Έ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ‹¤ν–‰ν•  μ λ„ μλ‹¤. κ·Έλ° μ‚¬μ‹¤λ„ λ¨λ¥Έμ²΄Β `OrderServiceImpl`μ€ λ¬µλ¬µν μμ‹ μ λ΅μ§μ„ μ‹¤ν–‰ν•  λΏμ΄λ‹¤.
- μ΄λ ‡λ“― ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ μ§μ ‘ μ μ–΄ν•λ” κ²ƒμ΄ μ•„λ‹λΌ μ™Έλ¶€μ—μ„ κ΄€λ¦¬ν•λ” κ²ƒμ„Β **μ μ–΄μ μ—­μ „(IoC)** μ΄λΌν•λ‹¤.


#### π“„ ν”„λ μ„μ›ν¬ vs λΌμ΄λΈλ¬λ¦¬
- ν”„λ μ„μ›ν¬κ°€ λ‚΄κ°€ μ‘μ„±ν• μ½”λ“λ¥Ό μ μ–΄ν•κ³ , λ€μ‹  μ‹¤ν–‰ν•λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ λ§λ‹¤. (JUnit)
- λ°λ©΄μ— λ‚΄κ°€ μ‘μ„±ν• μ½”λ“κ°€ μ§μ ‘ μ μ–΄μ νλ¦„μ„ λ‹΄λ‹Ήν•λ‹¤λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ μ•„λ‹λΌ λΌμ΄λΈλ¬λ¦¬λ‹¤.


### π“ μμ΅΄ κ΄€κ³„ μ£Όμ… DI(Dependency Injection)
- `OrderServiceImpl`μ€Β `DiscountPolicy`Β μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ‹¤. μ‹¤μ  μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ μ‚¬μ©λ μ§€λ” λ¨λ¥Έλ‹¤.
- μμ΅΄κ΄€κ³„λ” μ •μ μΈ ν΄λμ¤ μμ΅΄ κ΄€κ³„μ™€, μ‹¤ν–‰ μ‹μ μ— κ²°μ •λλ” λ™μ μΈ κ°μ²΄(μΈμ¤ν„΄μ¤) μμ΅΄ κ΄€κ³„ λ‘μ„ λ¶„λ¦¬ν•΄μ„ μƒκ°ν•΄μ•Ό ν•λ‹¤.

#### π“„ μ •μ μΈ ν΄λμ¤ μμ΅΄κ΄€κ³„
- ν΄λμ¤κ°€ μ‚¬μ©ν•λ” import μ½”λ“λ§ λ³΄κ³  μμ΅΄κ΄€κ³„λ¥Ό μ‰½κ² νλ‹¨ν•  μ μλ‹¤.
- μ •μ μΈ μμ΅΄κ΄€κ³„λ” μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•μ§€ μ•μ•„λ„ λ¶„μ„ν•  μ μλ‹¤.
- ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨μ„ λ³΄μΒ `OrderServiceImpl`μ€Β `MemberRepository`,Β `DiscountPolicy`μ— μμ΅΄ν•λ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤. κ·Έλ°λ° μ΄λ¬ν• ν΄λμ¤ μμ΅΄κ΄€κ³„ λ§μΌλ΅λ” μ‹¤μ  μ–΄λ–¤ κ°μ²΄κ°€Β `OrderServiceImpl`μ— μ£Όμ… λ μ§€ μ• μ μ—†λ‹¤.

#### ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨
![|500](https://blog.kakaocdn.net/dn/1yeOh/btrCMa5ofZ1/ntByBCgKf2u1FFJlKddvF1/img.png)

#### π“„ λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄κ΄€κ³„
- μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹μ μ— μ‹¤μ  μƒμ„±λ κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°κ°€ μ—°κ²°λ μμ΅΄ κ΄€κ³„λ‹¤.
- μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹μ (λ°νƒ€μ„)μ— μ™Έλ¶€μ—μ„ μ‹¤μ  κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬ν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ‹¤μ  μμ΅΄κ΄€κ³„κ°€ μ—°κ²°λλ” κ²ƒμ„ μμ΅΄κ΄€κ³„ μ£Όμ…μ΄λΌ ν•λ‹¤.
- κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•κ³ , κ·Έ μ°Έμ΅°κ°’μ„ μ „λ‹¬ν•΄μ„ μ—°κ²°λλ‹¤.
- μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , ν΄λΌμ΄μ–ΈνΈκ°€ νΈμ¶ν•λ” λ€μƒμ νƒ€μ… μΈμ¤ν„΄μ¤λ¥Ό λ³€κ²½ν•  μ μλ‹¤.
- μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ μ •μ μΈ ν΄λμ¤ μμ΅΄κ΄€κ³„λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄κ΄€κ³„λ¥Ό μ‰½κ² λ³€κ²½ν•  μ μλ‹¤.

#### κ°μ²΄ λ‹¤μ΄μ–΄κ·Έλ¨

![|500](https://blog.kakaocdn.net/dn/rExmS/btrCLAXzsQ1/8Sd1nqUb7A1VGUy2joNTx1/img.png)


### π“„ IoC μ»¨ν…μ΄λ„, DI μ»¨ν…μ΄λ„
- `AppConfig`μ²λΌ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬ν•λ©΄μ„ μμ΅΄κ΄€κ³„λ¥Ό μ—°κ²°ν•΄ μ£Όλ” κ²ƒμ„ IoC μ»¨ν…μ΄λ„ λλ” DI μ»¨ν…μ΄λ„λΌ ν•λ‹¤.
- μμ΅΄κ΄€κ³„ μ£Όμ…μ— μ΄μ μ„ λ§μ¶”μ–΄ μµκ·Όμ—λ” μ£Όλ΅ DI μ»¨ν…μ΄λ„λΌ ν•λ‹¤.
- λλ” μ–΄μƒλΈ”λ¬, μ¤λΈμ νΈ ν©ν† λ¦¬ λ“±μΌλ΅ λ¶λ¦¬κΈ°λ„ ν•λ‹¤.



## π“ μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°
μ§€κΈκΉμ§€ μμν• μλ°” μ½”λ“λ§μΌλ΅ DIλ¥Ό μ μ©ν–λ‹¤. μ΄μ  μ¤ν”„λ§μ„ μ‚¬μ©ν•΄λ³΄μ.
μ§€κΈμ€ μ½”λ“λ§ μ‘μ„±ν•κ³  μ„¤λ…μ€ λ§μ§€λ§‰μ— ν•κ² λ‹¤.

### `AppConfig`Β μ¤ν”„λ§ κΈ°λ°μΌλ΅ λ³€κ²½
```java
@Configuration
public class AppConfig {

    @Bean
    public MemberService memberService(){
        return new MemberServiceImpl(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository(){
        return new MemoryMemberRepository();
    }

    @Bean
    public OrderService orderService(){
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    @Bean
    public DiscountPolicy discountPolicy(){
        return new RateDiscountPolicy();
    }
}
```
- `AppConfig`μ— μ„¤μ •μ„ κµ¬μ„±ν•λ‹¤λ” λ»μΒ `@Configuration`μ„ λ¶™μ—¬μ¤€λ‹¤.
- κ° λ©”μ„λ“μ—Β `@Bean`μ„ λ¶™μ—¬μ¤€λ‹¤. μ΄λ ‡κ² ν•λ©΄ μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ‹¤.


### `MemberApp`μ— μ¤ν”„λ§ μ»¨ν…μ΄λ„ μ μ©
```java
public class MemberApp {

    public static void main(String[] args){
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);

        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member = " + member.getName());
        System.out.println("find member = " + findMember.getName());
    }
}
```

### `OrderApp`μ— μ¤ν”„λ§ μ»¨ν…μ΄λ„ μ μ©
```java
package hello.core;

public class OrderApp {

    public static void main(String[] args){
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);
        OrderService orderService = applicationContext.getBean("orderService", OrderService.class);

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 20000);

        System.out.println("order = " + order.toString());
    }
}
```
λ‘ μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ©΄ μ¤ν”„λ§ κ΄€λ ¨ λ΅κ·Έκ°€ λ‡μ¤„ μ‹¤ν–‰λλ©΄μ„ κΈ°μ΅΄κ³Ό λ™μΌν• κ²°κ³Όκ°€ μ¶λ ¥λλ‹¤.


## π“ μ¤ν”„λ§ μ»¨ν…μ΄λ„
### `ApplicationContext`λ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„λΌ ν•λ‹¤.
- κΈ°μ΅΄μ—λ” κ°λ°μκ°€Β `AppConfig`λ¥Ό μ‚¬μ©ν•΄μ„ μ§μ ‘ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  DIλ¥Ό ν–μ§€λ§, μ΄μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„λ¥Ό ν†µν•΄μ„ μ‚¬μ©ν•λ‹¤.
- μ¤ν”„λ§ μ»¨ν…μ΄λ„λ”Β `@Configuration`μ΄ λ¶™μ€Β `AppConfig`λ¥Ό μ„¤μ •(κµ¬μ„±) μ •λ³΄λ΅ μ‚¬μ©ν•λ‹¤. μ—¬κΈ°μ„Β `@Bean`μ΄λΌ μ ν λ©”μ„λ“λ¥Ό λ¨λ‘ νΈμ¶ν•΄μ„ λ°ν™λ κ°μ²΄λ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅ν•λ‹¤. μ΄λ ‡κ² μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅λ κ°μ²΄λ¥Ό μ¤ν”„λ§ λΉμ΄λΌ ν•λ‹¤.
- μ¤ν”„λ§ λΉμ€Β `@Bean`μ΄ λ¶™μ€ λ©”μ„λ“μ λ…μ„ μ¤ν”„λ§ λΉμ μ΄λ¦„μΌλ΅ μ‚¬μ©ν•λ‹¤. (`memberService`,Β `orderService`)
- μ΄μ „μ—λ” κ°λ°μκ°€ ν•„μ”ν• κ°μ²΄λ¥ΌΒ `AppConfig`λ¥Ό μ‚¬μ©ν•΄μ„ μ§μ ‘ μ΅°νν–μ§€λ§, μ΄μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„λ¥Ό ν†µν•΄μ„ ν•„μ”ν• μ¤ν”„λ§ λΉ(κ°μ²΄)λ¥Ό μ°Ύμ•„μ•Ό ν•λ‹¤. μ¤ν”„λ§ λΉμ€Β `applicationContext.getBean()`Β λ©”μ„λ“λ¥Ό μ‚¬μ©ν•΄μ„ μ°Ύμ„ μ μλ‹¤.
- κΈ°μ΅΄μ—λ” κ°λ°μκ°€ μ§μ ‘ μλ°”μ½”λ“λ΅ λ¨λ“  κ²ƒμ„ ν–λ‹¤λ©΄ μ΄μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— κ°μ²΄λ¥Ό μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•κ³ , μ¤ν”„λ§ μ»¨ν…μ΄λ„μ—μ„ μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ‚¬μ©ν•λ„λ΅ λ³€κ²½λμ—λ‹¤.
