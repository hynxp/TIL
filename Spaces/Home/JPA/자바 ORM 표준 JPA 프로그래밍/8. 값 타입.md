### ê¸°ë³¸ê°’ íƒ€ì…

> **JPAì˜ ë°ì´í„° íƒ€ì… ë¶„ë¥˜**

- ì—”í‹°í‹° íƒ€ì…
    - @Entityë¡œ ì •ì˜í•˜ëŠ” ê°ì²´
    - ë°ì´í„°ê°€ ë³€í•´ë„ ì‹ë³„ìë¡œ ì§€ì†í•´ì„œ ì¶”ì  ê°€ëŠ¥
    - ì˜ˆ) íšŒì› ì—”í‹°í‹°ì˜ í‚¤ë‚˜ ë‚˜ì´ ê°’ì„ ë³€ê²½í•´ë„ ì‹ë³„ìë¡œ ì¸ì‹ ê°€ëŠ¥
- ê°’ íƒ€ì…
    - Int, Integer, Stringì²˜ëŸ¼ ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìë°” ê¸°ë³¸ íƒ€ì…ì´ë‚˜ ê°ì²´
    - ì‹ë³„ìê°€ ì—†ê³  ê°’ë§Œ ìˆìœ¼ë¯€ë¡œ ë³€ê²½ì‹œ ì¶”ì  ë¶ˆê°€
    - ì˜ˆ) ìˆ«ì 100ì„ 200ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì²´

> **ê°’ íƒ€ì… ë¶„ë¥˜**

- ê¸°ë³¸ê°’ íƒ€ì…
    - ìë°” ê¸°ë³¸ íƒ€ì…(int, double)
    - ë˜í¼ í´ë˜ìŠ¤(Integer, Long)
    - String
- ì„ë² ë””ë“œ íƒ€ì…(embedded type, ë³µí•© ê°’ íƒ€ì…)
- ì»¬ë ‰ì…˜ ê°’ íƒ€ì…(collection value type)

> **ê¸°ë³¸ê°’ íƒ€ì…**

<aside> ğŸ’¡ ìë°”ì˜ ê¸°ë³¸ íƒ€ì…ì€ ì ˆëŒ€ ê³µìœ X

</aside>

- int, double ê°™ì€ ê¸°ë³¸ íƒ€ì…(primitive type)ì€ ì ˆëŒ€ ê³µìœ X
- ê¸°ë³¸ íƒ€ì…ì€ í•­ìƒ ê°’ì„ ë³µì‚¬í•¨
- Integerê°™ì€ ë˜í¼ í´ë˜ìŠ¤ë‚˜ String ê°™ì€ íŠ¹ìˆ˜í•œ í´ë˜ìŠ¤ëŠ” ê³µìœ  ê°€ëŠ¥í•œ ê°ì²´ì´ì§€ë§Œ ë³€ê²½X

### ì„ë² ë””ë“œ íƒ€ì…

> **ì„ë² ë””ë“œ íƒ€ì…(ë³µí•© ê°’ íƒ€ì…)**

- ìƒˆë¡œìš´ ê°’ íƒ€ì…ì„ ì§ì ‘ ì •ì˜í•  ìˆ˜ ìˆìŒ
- JPAëŠ” ì„ë² ë””ë“œ íƒ€ì…(embedded type)ì´ë¼ í•¨
- ì£¼ë¡œ ê¸°ë³¸ ê°’ íƒ€ì…ì„ ëª¨ì•„ì„œ ë§Œë“¤ì–´ì„œ ë³µí•© ê°’ íƒ€ì…ì´ë¼ê³ ë„ í•¨
- int, Stringê³¼ ê°™ì€ ê°’ íƒ€ì…

ex) íšŒì› ì—”í‹°í‹°ëŠ” ì´ë¦„, ê·¼ë¬´ ì‹œì‘ì¼, ê·¼ë¬´ ì¢…ë£Œì¼, ì£¼ì†Œ ë„ì‹œ, ì£¼ì†Œ ë²ˆì§€, ì£¼ì†Œ ìš°í¸ë²ˆí˜¸ë¥¼ ê°€ì§„ë‹¤

![BEFORE](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/feb4ecf3-971c-4f2e-8126-88c6815e6b43/Untitled.png)

BEFORE

```java
@Entity
public class Member {

    @Id @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String username;

    //ê¸°ê°„ period
		private LocalDateTime startDate;
    private LocalDateTime endDate;

    //ì£¼ì†Œ
		private String city;
    private String street;
    private String zipcode;

}
```

ex) íšŒì› ì—”í‹°í‹°ëŠ” ì´ë¦„, ê·¼ë¬´ ê¸°ê°„, ì§‘ ì£¼ì†Œë¥¼ ê°€ì§„ë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/87f29d0d-6d0d-4e79-9d83-89ec16c89c9d/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8c42037-8775-4dd7-add5-c25382300fff/Untitled.png)

```java
@Entity
public class Member {

    @Id @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String username;

    //ê¸°ê°„
    @Embedded
    private Period workPeriod;

    //ì£¼ì†Œ
    @Embedded
    private Address homeAddress;
}
```

```java
@Embeddable
public class Period {

    private LocalDateTime startDate;
    private LocalDateTime endDate;
}

@Embeddable
public class Address {

    private String city;
    private String street;
    private String zipcode;

    public Address() {
    }

    public Address(String city, String street, String zipcode) {
        this.city = city;
        this.street = street;
        this.zipcode = zipcode;
    }
}
```

> **ì‚¬ìš©ë²•**

- @Embeddable: ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ
- @Embedded: ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ
- ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜

> **ì¥ì **

- ì¬ì‚¬ìš©
- ë†’ì€ ì‘ì§‘ë„
- Period.isWork()ì²˜ëŸ¼ í•´ë‹¹ ê°’ íƒ€ì…ë§Œ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ ìˆëŠ” ë©”ì†Œ ë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ
- ì„ë² ë””ë“œ íƒ€ì…ì„ í¬í•¨í•œ ëª¨ë“  ê°’ íƒ€ì…ì€, ê°’ íƒ€ì…ì„ ì†Œìœ í•œ ì—”í‹° í‹°ì— ìƒëª…ì£¼ê¸°ë¥¼ ì˜ì¡´í•¨

> **ì„ë² ë””ë“œ íƒ€ì…ê³¼ í…Œì´ë¸” ë§¤í•‘**

- ì„ë² ë””ë“œ íƒ€ì…ì€ ì—”í‹°í‹°ì˜ ê°’ì¼ ë¿ì´ë‹¤.
- ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ê¸° ì „ê³¼ í›„ì— ë§¤í•‘í•˜ëŠ” í…Œì´ë¸”ì€ ê°™ë‹¤.
- ê°ì²´ì™€ í…Œì´ë¸”ì„ ì•„ì£¼ ì„¸ë°€í•˜ê²Œ(find-grained) ë§¤í•‘í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥
- ì˜ ì„¤ê³„í•œ ORM ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë§¤í•‘í•œ í…Œì´ë¸”ì˜ ìˆ˜ë³´ë‹¤ í´ë˜ìŠ¤ì˜ ìˆ˜ê°€ ë” ë§ìŒ

> **@AttributeOverride: ì†ì„± ì¬ì •ì˜**

ex) Member í´ë˜ìŠ¤ì—ì„œ ê°™ì€ ì—”í‹°í‹°ë¥¼ ì—¬ëŸ¬ë²ˆ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´?

= ì»¬ëŸ¼ ëª… ì¤‘ë³µìœ¼ë¡œ ì—ëŸ¬

@AttributeOverrides, @AttributeOverrideë¥¼ ì‚¬ìš©í•´ì„œ ì»¬ëŸ¼ ëª… ì†ì„±ì„ ì¬ì •ì˜

```java
@Entity
public class Member {

    @Id @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String username;

    //ê¸°ê°„ period
    @Embedded
    private Period workPeriod;

    //ì§‘ ì£¼ì†Œ
    @Embedded
    private Address homeAddress;

    //íšŒì‚¬ ì£¼ì†Œ
    @Embedded
    @AttributeOverrides({
       @AttributeOverride(name = "city", column = @Column(name = "WORK_CITY"))
      ,@AttributeOverride(name = "street", column = @Column(name = "WORK_STREET"))
      ,@AttributeOverride(name = "zipcode", column = @Column(name = "WORK_ZIPCODE"))
                        })
    private Address workAddress;
}
```

### ê°’ íƒ€ì…ê³¼ ë¶ˆë³€ ê°ì²´

<aside> ğŸ’¡ ê°’ íƒ€ì…ì€ ë³µì¡í•œ ê°ì²´ ì„¸ìƒì„ ì¡°ê¸ˆì´ë¼ë„ ë‹¨ìˆœí™”í•˜ë ¤ê³  ë§Œë“  ê°œë…ì´ë‹¤. ë”°ë¼ì„œ ê°’ íƒ€ì…ì€ ë‹¨ìˆœí•˜ê³  ì•ˆì „í•˜ê²Œ ë‹¤ë£° ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

</aside>

> **ê°’ íƒ€ì… ê³µìœ  ì°¸ì¡°**

- ì„ë² ë””ë“œ íƒ€ì… ê°™ì€ ê°’ íƒ€ì…ì„ ì—¬ëŸ¬ ì—”í‹°í‹°ì—ì„œ ê³µìœ í•˜ë©´ ìœ„í—˜í•¨
- ë¶€ì‘ìš©(side effect) ë°œìƒ

> **ê°’ íƒ€ì… ë³µì‚¬**

- ê°’ íƒ€ì…ì˜ ì‹¤ì œ ì¸ìŠ¤í„´ìŠ¤ì¸ ê°’ì„ ê³µìœ í•˜ëŠ” ê²ƒì€ ìœ„í—˜
- ëŒ€ì‹  ê°’(ì¸ìŠ¤í„´ìŠ¤)ë¥¼ ë³µì‚¬í•´ì„œ ì‚¬ìš©

```java
Address address = new Address("city", "street", "10000");

Member member1 = new Member();
member1.setUsername("member1");
member1.setHomeAddress(address);
em.persist(member1);

Member member2 = new Member();
member2.setUsername("member2");
member2.setHomeAddress(address);
em.persist(member2);

member1.getHomeAddress().setCity("newCity");
```

member1ì˜ addressë¥¼ â€œnewCityâ€ë¡œ ë°”ê¿”ì•¼ì§€ í•˜ê³  ì´ë ‡ê²Œ í–ˆë‹¤ê°„

```
Hibernate: 
    /* update
        hellojpa.Member */ update
            Member 
        set
            city=?,
            street=?,
            zipcode=?,
            USERNAME=?,
            endDate=?,
            startDate=? 
        where
            MEMBER_ID=?
Hibernate: 
    /* update
        hellojpa.Member */ update
            Member 
        set
            city=?,
            street=?,
            zipcode=?,
            USERNAME=?,
            endDate=?,
            startDate=? 
        where
            MEMBER_ID=?
```

update ì¿¼ë¦¬ê°€ 2ë²ˆ ë‚˜ê°„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

member2ì˜ addressë„ ê°™ì´ ë°”ë€ë‹¤.

> **ê°ì²´ íƒ€ì…ì˜ í•œê³„**

- í•­ìƒ ê°’ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ë©´ ê³µìœ  ì°¸ì¡°ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¶€ì‘ìš©ì„ í”¼í•  ìˆ˜ ìˆë‹¤.
    
- ë¬¸ì œëŠ” ì„ë² ë””ë“œ íƒ€ì…ì²˜ëŸ¼ **ì§ì ‘ ì •ì˜í•œ ê°’ íƒ€ì…ì€ ìë°”ì˜ ê¸°ë³¸íƒ€ì…ì´ ì•„ë‹ˆë¼ ê°ì²´ íƒ€ì…**ì´ë‹¤.
    
- ìë°” ê¸°ë³¸ íƒ€ì…ì— ê°’ì„ ëŒ€ì…í•˜ë©´ ê°’ì„ ë³µì‚¬í•œë‹¤.
    
- **ê°ì²´ íƒ€ì…ì€ ì°¸ì¡° ê°’ì„ ì§ì ‘ ëŒ€ì…í•˜ëŠ” ê²ƒì„ ë§‰ì„ ë°©ë²•ì´ ì—†ë‹¤.**
    
- **ê°ì²´ì˜ ê³µìœ  ì°¸ì¡°ëŠ” í”¼í•  ìˆ˜ ì—†ë‹¤.**
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0997df6b-8d1e-4582-8424-fb51c7758b2f/Untitled.png)
    

> **ë¶ˆë³€ ê°ì²´**

- ê°ì²´ íƒ€ì…ì„ ìˆ˜ì •í•  ìˆ˜ ì—†ê²Œ ë§Œë“¤ë©´ ë¶€ì‘ìš©ì„ ì›ì²œ ì°¨ë‹¨
- **ê°’ íƒ€ì…ì€ ë¶ˆë³€ ê°ì²´(immutable object)ë¡œ ì„¤ê³„í•´ì•¼í•¨**
- **ë¶ˆë³€ ê°ì²´: ìƒì„± ì‹œì  ì´í›„ ì ˆëŒ€ ê°’ì„ ë³€ê²½í•  ìˆ˜ ì—†ëŠ” ê°ì²´**
- ìƒì„±ìë¡œë§Œ ê°’ì„ ì„¤ì •í•˜ê³  ìˆ˜ì •ì(Setter)ë¥¼ ë§Œë“¤ì§€ ì•Šìœ¼ë©´ ë¨
    - ë˜ëŠ” setOOë¥¼ privateë¡œ ë°”ê¿”ë²„ë¦¬ê¸°
- ì°¸ê³ : Integer, Stringì€ ìë°”ê°€ ì œê³µí•˜ëŠ” ëŒ€í‘œì ì¸ ë¶ˆë³€ ê°ì²´

```java
Address address = new Address("city", "street", "10000");

Member member1 = new Member();
member1.setUsername("member1");
member1.setHomeAddress(address);
em.persist(member1);

Address copyAddress = new Address("city", address.getStreet(), address.getZipcode());

member1.setHomeAddress(copyAddress);
```

ì•„ì˜ˆ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ ì£¼ì…í•˜ëŠ”ê²Œ ì¢‹ë‹¤.

### ê°’ íƒ€ì…ì˜ ë¹„êµ

ê°’ íƒ€ì…: ì¸ìŠ¤í„´ìŠ¤ê°€ ë‹¬ë¼ë„ ê·¸ ì•ˆì— ê°’ì´ ê°™ìœ¼ë©´ ê°™ì€ ê²ƒìœ¼ë¡œ ë´ì•¼ í•¨

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7c0bf190-0762-4a5b-85fc-1fc0371d8039/Untitled.png)

- **ë™ì¼ì„±(identity) ë¹„êµ**: ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡° ê°’ì„ ë¹„êµ, == ì‚¬ìš©
- **ë™ë“±ì„±(equivalence) ë¹„êµ**: ì¸ìŠ¤í„´ìŠ¤ì˜ ê°’ì„ ë¹„êµ, equals()ì‚¬ìš©
- ê°’ íƒ€ì…ì€ a.equals(b)ë¥¼ ì‚¬ìš©í•´ì„œ ë™ë“±ì„± ë¹„êµë¥¼ í•´ì•¼ í•¨
- ê°’ íƒ€ì…ì˜ equals() ë©”ì†Œë“œë¥¼ ì ì ˆí•˜ê²Œ ì¬ì •ì˜(ì£¼ë¡œ ëª¨ë“  í•„ë“œì‚¬ìš©)

### ê°’ íƒ€ì… ì»¬ë ‰ì…˜